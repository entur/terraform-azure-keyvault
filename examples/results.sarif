{"$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json", "version": "2.1.0", "runs": [{"tool": {"driver": {"name": "Checkov", "version": "2.4.55", "informationUri": "https://checkov.io", "rules": [{"id": "CKV_AZURE_189", "name": "Ensure that Azure Key Vault disables public network access", "shortDescription": {"text": "Ensure that Azure Key Vault disables public network access"}, "fullDescription": {"text": "Ensure that Azure Key Vault disables public network access"}, "help": {"text": "Ensure that Azure Key Vault disables public network access\nResource: module.keyvault.azurerm_key_vault.main"}, "defaultConfiguration": {"level": "error"}}, {"id": "CKV_TF_1", "name": "Ensure Terraform module sources use a commit hash", "shortDescription": {"text": "Ensure Terraform module sources use a commit hash"}, "fullDescription": {"text": "Ensure Terraform module sources use a commit hash"}, "help": {"text": "Ensure Terraform module sources use a commit hash\nResource: keyvault"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/supply-chain-policies/terraform-policies/ensure-terraform-module-sources-use-git-url-with-commit-hash-revision.html"}], "organization": "bridgecrew"}}, "results": [{"ruleId": "CKV_AZURE_189", "ruleIndex": 0, "level": "error", "attachments": [], "message": {"text": "Ensure that Azure Key Vault disables public network access"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": ".external_modules/github.com/entur/terraform-azure-keyvault/v0.0.3/main.tf"}, "region": {"startLine": 15, "endLine": 34, "snippet": {"text": "resource \"azurerm_key_vault\" \"main\" {\n  name                       = local.key_vault_name\n  location                   = var.location\n  resource_group_name        = var.resource_group_name\n  tenant_id                  = data.azurerm_client_config.current.tenant_id\n  soft_delete_retention_days = var.soft_delete_retention_days\n  purge_protection_enabled   = var.purge_protection_enabled\n  enable_rbac_authorization  = true\n\n  sku_name = \"standard\"\n\n  network_acls {\n    bypass         = \"None\"\n    default_action = \"Deny\"\n  }\n\n  lifecycle {\n    prevent_destroy = true\n  }\n}\n"}}}}]}, {"ruleId": "CKV_TF_1", "ruleIndex": 1, "level": "error", "attachments": [], "message": {"text": "Ensure Terraform module sources use a commit hash"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "main.tf"}, "region": {"startLine": 11, "endLine": 24, "snippet": {"text": "module \"keyvault\" {\n  source = \"github.com/entur/terraform-azure-keyvault?ref=v0.0.3\"\n  # source = \"../\"\n\n  resource_group_name = var.resource_group_name\n  location            = var.location\n  tags                = var.tags\n\n  app_name                   = var.app_name\n  environment                = var.environment\n  landing_zone               = var.landing_zone\n  purge_protection_enabled   = var.purge_protection_enabled\n  soft_delete_retention_days = var.soft_delete_retention_days\n}\n"}}}}]}]}]}